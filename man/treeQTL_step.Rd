% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/treeQTL.R
\name{treeQTL_step}
\alias{treeQTL_step}
\title{Multiple Testing Correction}
\usage{
treeQTL_step(
  data_dir,
  snps_location_file_name,
  gene_location_file_name,
  context_names,
  out_dir,
  fdr_thresh = 0.05,
  four_level = FALSE,
  treeBH_method = "cpp",
  treeBH_test = "simes"
)
}
\arguments{
\item{data_dir}{\itemize{
\item full filepath of the directory where eQTL output files are stored. This function assumes that files are named as outputted by FastGxC's eQTL mapping function
}}

\item{snps_location_file_name}{\itemize{
\item full filepath of the snpsloc file used in the eQTL mapping step
}}

\item{gene_location_file_name}{\itemize{
\item full filepath of the geneloc file used in the eQTL mapping step
}}

\item{context_names}{\itemize{
\item vector of all context names in the format c("tissue1", "tissue2", ..., etc.)
}}

\item{out_dir}{\itemize{
\item full filepath of the output directory that FDR adjusted eQTLs should be written out to.
}}

\item{fdr_thresh}{\itemize{
\item value between 0 and 1 that signifies what FDR threshold for multiple testing correction. The same value will be used across all hierarchical levels.
}}

\item{four_level}{\itemize{
\item boolean value (T or F) that signifies whether to use the 4-level hierarchy (set this parameter to R and test for a global eQTL across shared and specific components) or a 3-level hierarchy (this parameter is default set to F to test for shared vs specific eQTLs)
}}

\item{treeBH_method}{\itemize{
\item character string specifying which TreeBH implementation to use when four_level = TRUE. Options: "original" (TreeBH package), "datatable" (optimized R), "cpp" (fast C++ implementation, default). Ignored when four_level = FALSE.
}}

\item{treeBH_test}{\itemize{
\item character string specifying the p-value aggregation method for TreeBH when four_level = TRUE. Options: "simes" (Simes' method, default), "fisher" (Fisher's method). Ignored when four_level = FALSE.
}}
}
\value{
outputs one file of specific eGenes across all contexts and one file of shared eGenes. Outputs an eAssociation file for each context and one for shared eQTLs with snp-gene pairs and FDR adjusted p-values.
}
\description{
Function to adjust for hierarchical multiple testing correction using TreeQTL. Runs multiple testing correction for both FastGxC shared and specific eQTLs.
}
